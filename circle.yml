machine:
  php:
    version: 7.0.4
dependencies:
  cache_directories:
    - ~/.composer/cache
  pre:
    - composer install --prefer-dist --no-interaction
    - php -r "file_exists('.env') || copy('.env.example', '.env');"
    - php artisan key:generate
test:
  override:
    - ? |
        case $CIRCLE_NODE_INDEX in
          0) vendor/bin/phpunit;;
          1) ./tests/shell_test.sh;;
          2) ./tests/shell_test.sh;;
          3) ./tests/shell_test.sh;;
          4) ./tests/shell_test.sh;;
          5) ./tests/shell_test.sh;;
          6) ./tests/shell_test.sh;;
          7) ./tests/shell_test.sh;;
          8) ./tests/shell_test.sh;;
          9) echo $CIRCLE_NODE_TOTAL;;
        esac
      :
        parallel: true
